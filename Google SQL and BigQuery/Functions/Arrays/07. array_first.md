🚀 **BigQuery Tip of the Day: `ARRAY_FIRST()`**

When working with arrays in BigQuery, accessing specific elements is a common task. Instead of manually indexing the first element, BigQuery provides a built-in function:

### 🔎 `ARRAY_FIRST(array_expression)`

It simply returns the **first element** of an array — making it easier to access data without manual indexing.

✅ **Syntax:**

```sql
ARRAY_FIRST(array_expression)
```

**What it does:**
Returns the **first element** of an array. This is especially useful when dealing with nested or repeated fields, or when arrays are generated as part of your query logic.


📌 **Important notes:**

* Returns `NULL` if the array itself is `NULL`.
* Throws an **error** if the array is **empty**.
* The return type matches the data type of the array elements.

✅ Key points:

* Returns the first element of an array.
* Returns NULL if the array is NULL.
* Throws an error if the array is empty.
* Return type matches the array element type.

💡 **Example:**

```sql
SELECT ARRAY_FIRST(['a', 'b', 'c', 'd']) AS first_element
```

📤 **Result:**

| first_element |
| ------------- |
| a             |

### 📊 Real-World Example: Get the First Purchased Category

Let’s say you have a table storing each user’s purchase categories as an array. You want to find the first category they ever bought.

🛠 Step 1: Create the table
```sql
CREATE OR REPLACE TABLE ecommerce.user_purchases (
  user_id STRING,
  categories ARRAY<STRING>
);
```

📥 Step 2: Insert some sample data
```sql
INSERT INTO ecommerce.user_purchases (user_id, categories)
VALUES
  ('U001', ['Electronics', 'Books', 'Clothing']),
  ('U002', ['Groceries', 'Toys']),
  ('U003', ['Books']);
```

📈 Step 3: Use ARRAY_FIRST() to extract the first category

```sql
SELECT
  user_id,
  ARRAY_FIRST(categories) AS first_category
FROM
  ecommerce.user_purchases;
```

✅ Result:

user_id	first_category
U001	Electronics
U002	Groceries
U003	Books

🔁 Pro Tip: If you’re analyzing user behavior, ARRAY_FIRST() is great for identifying their first product category, first session device, or initial event type — without complex indexing logic.

👉 Want the last element? Use ARRAY_LAST() instead.

#BigQuery #GoogleCloud #DataEngineering #SQL #CloudAnalytics #GCP #DataAnalytics #TechTips